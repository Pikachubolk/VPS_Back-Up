services:
    web:
        container_name: azuracast_web
        image: 'ghcr.io/azuracast/web:${AZURACAST_VERSION:-latest}'
        ports:
            - '${AZURACAST_HTTP_PORT:-80}:80'
            - '${AZURACAST_HTTPS_PORT:-443}:443'
            - '${AZURACAST_SFTP_PORT:-2022}:2022'
        depends_on:
            - mariadb
            - stations
            - redis
        env_file: azuracast.env
        environment:
            LANG: '${LANG:-en_US.UTF-8}'
            AZURACAST_DC_REVISION: 13
            AZURACAST_VERSION: '${AZURACAST_VERSION:-latest}'
            AZURACAST_SFTP_PORT: '${AZURACAST_SFTP_PORT:-2022}'
            NGINX_TIMEOUT: '${NGINX_TIMEOUT:-1800}'
            LETSENCRYPT_HOST: '${LETSENCRYPT_HOST:-}'
            LETSENCRYPT_EMAIL: '${LETSENCRYPT_EMAIL:-}'
            PUID: '${AZURACAST_PUID:-1000}'
            PGID: '${AZURACAST_PGID:-1000}'
            NGINX_RADIO_PORTS: (8000|8010|8020|8030|8040|8050|8060|8070|8090|8100|8110|8120|8130|8140|8150|8160|8170|8180|8190|8200|8210|8220|8230|8240|8250|8260|8270|8280|8290|8300|8310|8320|8330|8340|8350|8360|8370|8380|8390|8400|8410|8420|8430|8440|8450|8460|8470|8480|8490|8500|8510|8520|8530|8540|8550|8560|8570|8580|8590|8600|8610|8620|8630|8640|8650|8660|8670|8680|8690|8700|8710|8720|8730|8740|8750|8760|8770|8780|8790|8800|8810|8820|8830|8840|8850|8860|8870|8880|8890|8900|8910|8920|8930|8940|8950|8960|8970|8980|8990)
            NGINX_WEBDJ_PORTS: (8005|8015|8025|8035|8045|8055|8065|8075|8095|8105|8115|8125|8135|8145|8155|8165|8175|8185|8195|8205|8215|8225|8235|8245|8255|8265|8275|8285|8295|8305|8315|8325|8335|8345|8355|8365|8375|8385|8395|8405|8415|8425|8435|8445|8455|8465|8475|8485|8495|8505|8515|8525|8535|8545|8555|8565|8575|8585|8595|8605|8615|8625|8635|8645|8655|8665|8675|8685|8695|8705|8715|8725|8735|8745|8755|8765|8775|8785|8795|8805|8815|8825|8835|8845|8855|8865|8875|8885|8895|8905|8915|8925|8935|8945|8955|8965|8975|8985|8995)
        volumes:
            - 'letsencrypt:/etc/nginx/certs'
            - 'letsencrypt_acme:/etc/acme.sh'
            - 'www_vendor:/var/azuracast/www/vendor'
            - 'www_uploads:/var/azuracast/uploads'
            - 'tmp_data:/var/azuracast/www_tmp'
            - 'station_data:/var/azuracast/stations'
            - 'shoutcast2_install:/var/azuracast/servers/shoutcast2'
            - 'geolite_install:/var/azuracast/geoip'
            - 'sftpgo_data:/var/azuracast/sftpgo/persist'
            - 'backups:/var/azuracast/backups'
        networks:
            - frontend
            - backend
        restart: unless-stopped
        ulimits:
            nofile:
                soft: 65536
                hard: 65536
        logging:
            options:
                max-size: 1m
                max-file: '5'
    mariadb:
        container_name: azuracast_mariadb
        image: 'ghcr.io/azuracast/db:${AZURACAST_VERSION:-latest}'
        volumes:
            - 'db_data:/var/lib/mysql'
        env_file: azuracast.env
        networks:
            - backend
        restart: unless-stopped
        logging:
            options:
                max-size: 1m
                max-file: '5'
    redis:
        container_name: azuracast_redis
        image: 'ghcr.io/azuracast/redis:${AZURACAST_VERSION:-latest}'
        sysctls:
            net.core.somaxconn: 1024
        volumes:
            - 'redis_data:/data'
        networks:
            - backend
        restart: unless-stopped
        logging:
            options:
                max-size: 1m
                max-file: '5'
    stations:
        container_name: azuracast_stations
        image: 'ghcr.io/azuracast/radio:${AZURACAST_VERSION:-latest}'
        environment:
            PUID: '${AZURACAST_PUID:-1000}'
            PGID: '${AZURACAST_PGID:-1000}'
        ports:
            - '8000:8000'
            - '8005:8005'
            - '8006:8006'
            - '8010:8010'
            - '8015:8015'
            - '8016:8016'
            - '8020:8020'
            - '8025:8025'
            - '8026:8026'
            - '8030:8030'
            - '8035:8035'
            - '8036:8036'
            - '8040:8040'
            - '8045:8045'
            - '8046:8046'
            - '8050:8050'
            - '8055:8055'
            - '8056:8056'
            - '8060:8060'
            - '8065:8065'
            - '8066:8066'
            - '8070:8070'
            - '8075:8075'
            - '8076:8076'
            - '8090:8090'
            - '8095:8095'
            - '8096:8096'
            - '8100:8100'
            - '8105:8105'
            - '8106:8106'
            - '8110:8110'
            - '8115:8115'
            - '8116:8116'
            - '8120:8120'
            - '8125:8125'
            - '8126:8126'
            - '8130:8130'
            - '8135:8135'
            - '8136:8136'
            - '8140:8140'
            - '8145:8145'
            - '8146:8146'
            - '8150:8150'
            - '8155:8155'
            - '8156:8156'
            - '8160:8160'
            - '8165:8165'
            - '8166:8166'
            - '8170:8170'
            - '8175:8175'
            - '8176:8176'
            - '8180:8180'
            - '8185:8185'
            - '8186:8186'
            - '8190:8190'
            - '8195:8195'
            - '8196:8196'
            - '8200:8200'
            - '8205:8205'
            - '8206:8206'
            - '8210:8210'
            - '8215:8215'
            - '8216:8216'
            - '8220:8220'
            - '8225:8225'
            - '8226:8226'
            - '8230:8230'
            - '8235:8235'
            - '8236:8236'
            - '8240:8240'
            - '8245:8245'
            - '8246:8246'
            - '8250:8250'
            - '8255:8255'
            - '8256:8256'
            - '8260:8260'
            - '8265:8265'
            - '8266:8266'
            - '8270:8270'
            - '8275:8275'
            - '8276:8276'
            - '8280:8280'
            - '8285:8285'
            - '8286:8286'
            - '8290:8290'
            - '8295:8295'
            - '8296:8296'
            - '8300:8300'
            - '8305:8305'
            - '8306:8306'
            - '8310:8310'
            - '8315:8315'
            - '8316:8316'
            - '8320:8320'
            - '8325:8325'
            - '8326:8326'
            - '8330:8330'
            - '8335:8335'
            - '8336:8336'
            - '8340:8340'
            - '8345:8345'
            - '8346:8346'
            - '8350:8350'
            - '8355:8355'
            - '8356:8356'
            - '8360:8360'
            - '8365:8365'
            - '8366:8366'
            - '8370:8370'
            - '8375:8375'
            - '8376:8376'
            - '8380:8380'
            - '8385:8385'
            - '8386:8386'
            - '8390:8390'
            - '8395:8395'
            - '8396:8396'
            - '8400:8400'
            - '8405:8405'
            - '8406:8406'
            - '8410:8410'
            - '8415:8415'
            - '8416:8416'
            - '8420:8420'
            - '8425:8425'
            - '8426:8426'
            - '8430:8430'
            - '8435:8435'
            - '8436:8436'
            - '8440:8440'
            - '8445:8445'
            - '8446:8446'
            - '8450:8450'
            - '8455:8455'
            - '8456:8456'
            - '8460:8460'
            - '8465:8465'
            - '8466:8466'
            - '8470:8470'
            - '8475:8475'
            - '8476:8476'
            - '8480:8480'
            - '8485:8485'
            - '8486:8486'
            - '8490:8490'
            - '8495:8495'
            - '8496:8496'
            - '8500:8500'
            - '8505:8505'
            - '8506:8506'
            - '8510:8510'
            - '8515:8515'
            - '8516:8516'
            - '8520:8520'
            - '8525:8525'
            - '8526:8526'
            - '8530:8530'
            - '8535:8535'
            - '8536:8536'
            - '8540:8540'
            - '8545:8545'
            - '8546:8546'
            - '8550:8550'
            - '8555:8555'
            - '8556:8556'
            - '8560:8560'
            - '8565:8565'
            - '8566:8566'
            - '8570:8570'
            - '8575:8575'
            - '8576:8576'
            - '8580:8580'
            - '8585:8585'
            - '8586:8586'
            - '8590:8590'
            - '8595:8595'
            - '8596:8596'
            - '8600:8600'
            - '8605:8605'
            - '8606:8606'
            - '8610:8610'
            - '8615:8615'
            - '8616:8616'
            - '8620:8620'
            - '8625:8625'
            - '8626:8626'
            - '8630:8630'
            - '8635:8635'
            - '8636:8636'
            - '8640:8640'
            - '8645:8645'
            - '8646:8646'
            - '8650:8650'
            - '8655:8655'
            - '8656:8656'
            - '8660:8660'
            - '8665:8665'
            - '8666:8666'
            - '8670:8670'
            - '8675:8675'
            - '8676:8676'
            - '8680:8680'
            - '8685:8685'
            - '8686:8686'
            - '8690:8690'
            - '8695:8695'
            - '8696:8696'
            - '8700:8700'
            - '8705:8705'
            - '8706:8706'
            - '8710:8710'
            - '8715:8715'
            - '8716:8716'
            - '8720:8720'
            - '8725:8725'
            - '8726:8726'
            - '8730:8730'
            - '8735:8735'
            - '8736:8736'
            - '8740:8740'
            - '8745:8745'
            - '8746:8746'
            - '8750:8750'
            - '8755:8755'
            - '8756:8756'
            - '8760:8760'
            - '8765:8765'
            - '8766:8766'
            - '8770:8770'
            - '8775:8775'
            - '8776:8776'
            - '8780:8780'
            - '8785:8785'
            - '8786:8786'
            - '8790:8790'
            - '8795:8795'
            - '8796:8796'
            - '8800:8800'
            - '8805:8805'
            - '8806:8806'
            - '8810:8810'
            - '8815:8815'
            - '8816:8816'
            - '8820:8820'
            - '8825:8825'
            - '8826:8826'
            - '8830:8830'
            - '8835:8835'
            - '8836:8836'
            - '8840:8840'
            - '8845:8845'
            - '8846:8846'
            - '8850:8850'
            - '8855:8855'
            - '8856:8856'
            - '8860:8860'
            - '8865:8865'
            - '8866:8866'
            - '8870:8870'
            - '8875:8875'
            - '8876:8876'
            - '8880:8880'
            - '8885:8885'
            - '8886:8886'
            - '8890:8890'
            - '8895:8895'
            - '8896:8896'
            - '8900:8900'
            - '8905:8905'
            - '8906:8906'
            - '8910:8910'
            - '8915:8915'
            - '8916:8916'
            - '8920:8920'
            - '8925:8925'
            - '8926:8926'
            - '8930:8930'
            - '8935:8935'
            - '8936:8936'
            - '8940:8940'
            - '8945:8945'
            - '8946:8946'
            - '8950:8950'
            - '8955:8955'
            - '8956:8956'
            - '8960:8960'
            - '8965:8965'
            - '8966:8966'
            - '8970:8970'
            - '8975:8975'
            - '8976:8976'
            - '8980:8980'
            - '8985:8985'
            - '8986:8986'
            - '8990:8990'
            - '8995:8995'
            - '8996:8996'
        volumes:
            - 'station_data:/var/azuracast/stations'
            - 'shoutcast2_install:/var/azuracast/servers/shoutcast2'
            - 'letsencrypt:/etc/nginx/certs'
            - 'tmp_data:/var/azuracast/www_tmp'
        networks:
            - frontend
            - backend
        init: true
        restart: unless-stopped
        ulimits:
            nofile:
                soft: 65536
                hard: 65536
        logging:
            options:
                max-size: 1m
                max-file: '5'
networks:
    frontend:
        driver: bridge
    backend:
        driver: bridge
volumes:
    db_data: {  }
    letsencrypt: {  }
    letsencrypt_acme: {  }
    shoutcast2_install: {  }
    geolite_install: {  }
    sftpgo_data: {  }
    station_data: {  }
    www_vendor: {  }
    www_uploads: {  }
    tmp_data: {  }
    redis_data: {  }
    backups: {  }
