services:
    web:
        container_name: azuracast_web
        image: 'ghcr.io/azuracast/web:${AZURACAST_VERSION:-latest}'
        ports:
            - '${AZURACAST_HTTP_PORT:-80}:80'
            - '${AZURACAST_HTTPS_PORT:-443}:443'
            - '${AZURACAST_SFTP_PORT:-2022}:2022'
        depends_on:
            - mariadb
            - stations
            - redis
        env_file: azuracast.env
        environment:
            LANG: '${LANG:-en_US.UTF-8}'
            AZURACAST_DC_REVISION: 13
            AZURACAST_VERSION: '${AZURACAST_VERSION:-latest}'
            AZURACAST_SFTP_PORT: '${AZURACAST_SFTP_PORT:-2022}'
            NGINX_TIMEOUT: '${NGINX_TIMEOUT:-1800}'
            LETSENCRYPT_HOST: '${LETSENCRYPT_HOST:-}'
            LETSENCRYPT_EMAIL: '${LETSENCRYPT_EMAIL:-}'
            PUID: '${AZURACAST_PUID:-1000}'
            PGID: '${AZURACAST_PGID:-1000}'
            NGINX_RADIO_PORTS: (5000|5010|5020|5030|5040|5050|5060|5070|5080|5090|5100|5110|5120|5130|5140|5150|5160|5170|5180|5190|5200|5210|5220|5230|5240|5250|5260|5270|5280|5290|5300|5310|5320|5330|5340|5350|5360|5370|5380|5390|5400|5410|5420|5430|5440|5450|5460|5470|5480|5490|5500|5510|5520|5530|5540|5550|5560|5570|5580|5590|5600|5610|5620|5630|5640|5650|5660|5670|5680|5690|5700|5710|5720|5730|5740|5750|5760|5770|5780|5790|5800|5810|5820|5830|5840|5850|5860|5870|5880|5890|5900|5910|5920|5930|5940|5950|5960|5970|5980|5990|6000|6010|6020|6030|6040|6050|6060|6070|6080|6090|6100|6110|6120|6130|6140|6150|6160|6170|6180|6190|6200|6210|6220|6230|6240|6250|6260|6270|6280|6290|6300|6310|6320|6330|6340|6350|6360|6370|6380|6390|6400|6410|6420|6430|6440|6450|6460|6470|6480|6490|6500|6510|6520|6530|6540|6550|6560|6570|6580|6590|6600|6610|6620|6630|6640|6650|6660|6670|6680|6690|6700|6710|6720|6730|6740|6750|6760|6770|6780|6790|6800|6810|6820|6830|6840|6850|6860|6870|6880|6890|6900|6910|6920|6930|6940|6950|6960|6970|6980|6990)
            NGINX_WEBDJ_PORTS: (5005|5015|5025|5035|5045|5055|5065|5075|5085|5095|5105|5115|5125|5135|5145|5155|5165|5175|5185|5195|5205|5215|5225|5235|5245|5255|5265|5275|5285|5295|5305|5315|5325|5335|5345|5355|5365|5375|5385|5395|5405|5415|5425|5435|5445|5455|5465|5475|5485|5495|5505|5515|5525|5535|5545|5555|5565|5575|5585|5595|5605|5615|5625|5635|5645|5655|5665|5675|5685|5695|5705|5715|5725|5735|5745|5755|5765|5775|5785|5795|5805|5815|5825|5835|5845|5855|5865|5875|5885|5895|5905|5915|5925|5935|5945|5955|5965|5975|5985|5995|6005|6015|6025|6035|6045|6055|6065|6075|6085|6095|6105|6115|6125|6135|6145|6155|6165|6175|6185|6195|6205|6215|6225|6235|6245|6255|6265|6275|6285|6295|6305|6315|6325|6335|6345|6355|6365|6375|6385|6395|6405|6415|6425|6435|6445|6455|6465|6475|6485|6495|6505|6515|6525|6535|6545|6555|6565|6575|6585|6595|6605|6615|6625|6635|6645|6655|6665|6675|6685|6695|6705|6715|6725|6735|6745|6755|6765|6775|6785|6795|6805|6815|6825|6835|6845|6855|6865|6875|6885|6895|6905|6915|6925|6935|6945|6955|6965|6975|6985|6995)
        volumes:
            - 'letsencrypt:/etc/nginx/certs'
            - 'letsencrypt_acme:/etc/acme.sh'
            - 'www_vendor:/var/azuracast/www/vendor'
            - 'www_uploads:/var/azuracast/uploads'
            - 'tmp_data:/var/azuracast/www_tmp'
            - 'station_data:/var/azuracast/stations'
            - 'shoutcast2_install:/var/azuracast/servers/shoutcast2'
            - 'geolite_install:/var/azuracast/geoip'
            - 'sftpgo_data:/var/azuracast/sftpgo/persist'
            - 'backups:/var/azuracast/backups'
        networks:
            - frontend
            - backend
        restart: unless-stopped
        ulimits:
            nofile:
                soft: 65536
                hard: 65536
        logging:
            options:
                max-size: 1m
                max-file: '5'
    mariadb:
        container_name: azuracast_mariadb
        image: 'ghcr.io/azuracast/db:${AZURACAST_VERSION:-latest}'
        volumes:
            - 'db_data:/var/lib/mysql'
        env_file: azuracast.env
        networks:
            - backend
        restart: unless-stopped
        logging:
            options:
                max-size: 1m
                max-file: '5'
    redis:
        container_name: azuracast_redis
        image: 'ghcr.io/azuracast/redis:${AZURACAST_VERSION:-latest}'
        sysctls:
            net.core.somaxconn: 1024
        volumes:
            - 'redis_data:/data'
        networks:
            - backend
        restart: unless-stopped
        logging:
            options:
                max-size: 1m
                max-file: '5'
    stations:
        container_name: azuracast_stations
        image: 'ghcr.io/azuracast/radio:${AZURACAST_VERSION:-latest}'
        environment:
            PUID: '${AZURACAST_PUID:-1000}'
            PGID: '${AZURACAST_PGID:-1000}'
        ports:
            - '5000:5000'
            - '5005:5005'
            - '5006:5006'
            - '5010:5010'
            - '5015:5015'
            - '5016:5016'
            - '5020:5020'
            - '5025:5025'
            - '5026:5026'
            - '5030:5030'
            - '5035:5035'
            - '5036:5036'
            - '5040:5040'
            - '5045:5045'
            - '5046:5046'
            - '5050:5050'
            - '5055:5055'
            - '5056:5056'
            - '5060:5060'
            - '5065:5065'
            - '5066:5066'
            - '5070:5070'
            - '5075:5075'
            - '5076:5076'
            - '5080:5080'
            - '5085:5085'
            - '5086:5086'
            - '5090:5090'
            - '5095:5095'
            - '5096:5096'
            - '5100:5100'
            - '5105:5105'
            - '5106:5106'
            - '5110:5110'
            - '5115:5115'
            - '5116:5116'
            - '5120:5120'
            - '5125:5125'
            - '5126:5126'
            - '5130:5130'
            - '5135:5135'
            - '5136:5136'
            - '5140:5140'
            - '5145:5145'
            - '5146:5146'
            - '5150:5150'
            - '5155:5155'
            - '5156:5156'
            - '5160:5160'
            - '5165:5165'
            - '5166:5166'
            - '5170:5170'
            - '5175:5175'
            - '5176:5176'
            - '5180:5180'
            - '5185:5185'
            - '5186:5186'
            - '5190:5190'
            - '5195:5195'
            - '5196:5196'
            - '5200:5200'
            - '5205:5205'
            - '5206:5206'
            - '5210:5210'
            - '5215:5215'
            - '5216:5216'
            - '5220:5220'
            - '5225:5225'
            - '5226:5226'
            - '5230:5230'
            - '5235:5235'
            - '5236:5236'
            - '5240:5240'
            - '5245:5245'
            - '5246:5246'
            - '5250:5250'
            - '5255:5255'
            - '5256:5256'
            - '5260:5260'
            - '5265:5265'
            - '5266:5266'
            - '5270:5270'
            - '5275:5275'
            - '5276:5276'
            - '5280:5280'
            - '5285:5285'
            - '5286:5286'
            - '5290:5290'
            - '5295:5295'
            - '5296:5296'
            - '5300:5300'
            - '5305:5305'
            - '5306:5306'
            - '5310:5310'
            - '5315:5315'
            - '5316:5316'
            - '5320:5320'
            - '5325:5325'
            - '5326:5326'
            - '5330:5330'
            - '5335:5335'
            - '5336:5336'
            - '5340:5340'
            - '5345:5345'
            - '5346:5346'
            - '5350:5350'
            - '5355:5355'
            - '5356:5356'
            - '5360:5360'
            - '5365:5365'
            - '5366:5366'
            - '5370:5370'
            - '5375:5375'
            - '5376:5376'
            - '5380:5380'
            - '5385:5385'
            - '5386:5386'
            - '5390:5390'
            - '5395:5395'
            - '5396:5396'
            - '5400:5400'
            - '5405:5405'
            - '5406:5406'
            - '5410:5410'
            - '5415:5415'
            - '5416:5416'
            - '5420:5420'
            - '5425:5425'
            - '5426:5426'
            - '5430:5430'
            - '5435:5435'
            - '5436:5436'
            - '5440:5440'
            - '5445:5445'
            - '5446:5446'
            - '5450:5450'
            - '5455:5455'
            - '5456:5456'
            - '5460:5460'
            - '5465:5465'
            - '5466:5466'
            - '5470:5470'
            - '5475:5475'
            - '5476:5476'
            - '5480:5480'
            - '5485:5485'
            - '5486:5486'
            - '5490:5490'
            - '5495:5495'
            - '5496:5496'
            - '5500:5500'
            - '5505:5505'
            - '5506:5506'
            - '5510:5510'
            - '5515:5515'
            - '5516:5516'
            - '5520:5520'
            - '5525:5525'
            - '5526:5526'
            - '5530:5530'
            - '5535:5535'
            - '5536:5536'
            - '5540:5540'
            - '5545:5545'
            - '5546:5546'
            - '5550:5550'
            - '5555:5555'
            - '5556:5556'
            - '5560:5560'
            - '5565:5565'
            - '5566:5566'
            - '5570:5570'
            - '5575:5575'
            - '5576:5576'
            - '5580:5580'
            - '5585:5585'
            - '5586:5586'
            - '5590:5590'
            - '5595:5595'
            - '5596:5596'
            - '5600:5600'
            - '5605:5605'
            - '5606:5606'
            - '5610:5610'
            - '5615:5615'
            - '5616:5616'
            - '5620:5620'
            - '5625:5625'
            - '5626:5626'
            - '5630:5630'
            - '5635:5635'
            - '5636:5636'
            - '5640:5640'
            - '5645:5645'
            - '5646:5646'
            - '5650:5650'
            - '5655:5655'
            - '5656:5656'
            - '5660:5660'
            - '5665:5665'
            - '5666:5666'
            - '5670:5670'
            - '5675:5675'
            - '5676:5676'
            - '5680:5680'
            - '5685:5685'
            - '5686:5686'
            - '5690:5690'
            - '5695:5695'
            - '5696:5696'
            - '5700:5700'
            - '5705:5705'
            - '5706:5706'
            - '5710:5710'
            - '5715:5715'
            - '5716:5716'
            - '5720:5720'
            - '5725:5725'
            - '5726:5726'
            - '5730:5730'
            - '5735:5735'
            - '5736:5736'
            - '5740:5740'
            - '5745:5745'
            - '5746:5746'
            - '5750:5750'
            - '5755:5755'
            - '5756:5756'
            - '5760:5760'
            - '5765:5765'
            - '5766:5766'
            - '5770:5770'
            - '5775:5775'
            - '5776:5776'
            - '5780:5780'
            - '5785:5785'
            - '5786:5786'
            - '5790:5790'
            - '5795:5795'
            - '5796:5796'
            - '5800:5800'
            - '5805:5805'
            - '5806:5806'
            - '5810:5810'
            - '5815:5815'
            - '5816:5816'
            - '5820:5820'
            - '5825:5825'
            - '5826:5826'
            - '5830:5830'
            - '5835:5835'
            - '5836:5836'
            - '5840:5840'
            - '5845:5845'
            - '5846:5846'
            - '5850:5850'
            - '5855:5855'
            - '5856:5856'
            - '5860:5860'
            - '5865:5865'
            - '5866:5866'
            - '5870:5870'
            - '5875:5875'
            - '5876:5876'
            - '5880:5880'
            - '5885:5885'
            - '5886:5886'
            - '5890:5890'
            - '5895:5895'
            - '5896:5896'
            - '5900:5900'
            - '5905:5905'
            - '5906:5906'
            - '5910:5910'
            - '5915:5915'
            - '5916:5916'
            - '5920:5920'
            - '5925:5925'
            - '5926:5926'
            - '5930:5930'
            - '5935:5935'
            - '5936:5936'
            - '5940:5940'
            - '5945:5945'
            - '5946:5946'
            - '5950:5950'
            - '5955:5955'
            - '5956:5956'
            - '5960:5960'
            - '5965:5965'
            - '5966:5966'
            - '5970:5970'
            - '5975:5975'
            - '5976:5976'
            - '5980:5980'
            - '5985:5985'
            - '5986:5986'
            - '5990:5990'
            - '5995:5995'
            - '5996:5996'
            - '6000:6000'
            - '6005:6005'
            - '6006:6006'
            - '6010:6010'
            - '6015:6015'
            - '6016:6016'
            - '6020:6020'
            - '6025:6025'
            - '6026:6026'
            - '6030:6030'
            - '6035:6035'
            - '6036:6036'
            - '6040:6040'
            - '6045:6045'
            - '6046:6046'
            - '6050:6050'
            - '6055:6055'
            - '6056:6056'
            - '6060:6060'
            - '6065:6065'
            - '6066:6066'
            - '6070:6070'
            - '6075:6075'
            - '6076:6076'
            - '6080:6080'
            - '6085:6085'
            - '6086:6086'
            - '6090:6090'
            - '6095:6095'
            - '6096:6096'
            - '6100:6100'
            - '6105:6105'
            - '6106:6106'
            - '6110:6110'
            - '6115:6115'
            - '6116:6116'
            - '6120:6120'
            - '6125:6125'
            - '6126:6126'
            - '6130:6130'
            - '6135:6135'
            - '6136:6136'
            - '6140:6140'
            - '6145:6145'
            - '6146:6146'
            - '6150:6150'
            - '6155:6155'
            - '6156:6156'
            - '6160:6160'
            - '6165:6165'
            - '6166:6166'
            - '6170:6170'
            - '6175:6175'
            - '6176:6176'
            - '6180:6180'
            - '6185:6185'
            - '6186:6186'
            - '6190:6190'
            - '6195:6195'
            - '6196:6196'
            - '6200:6200'
            - '6205:6205'
            - '6206:6206'
            - '6210:6210'
            - '6215:6215'
            - '6216:6216'
            - '6220:6220'
            - '6225:6225'
            - '6226:6226'
            - '6230:6230'
            - '6235:6235'
            - '6236:6236'
            - '6240:6240'
            - '6245:6245'
            - '6246:6246'
            - '6250:6250'
            - '6255:6255'
            - '6256:6256'
            - '6260:6260'
            - '6265:6265'
            - '6266:6266'
            - '6270:6270'
            - '6275:6275'
            - '6276:6276'
            - '6280:6280'
            - '6285:6285'
            - '6286:6286'
            - '6290:6290'
            - '6295:6295'
            - '6296:6296'
            - '6300:6300'
            - '6305:6305'
            - '6306:6306'
            - '6310:6310'
            - '6315:6315'
            - '6316:6316'
            - '6320:6320'
            - '6325:6325'
            - '6326:6326'
            - '6330:6330'
            - '6335:6335'
            - '6336:6336'
            - '6340:6340'
            - '6345:6345'
            - '6346:6346'
            - '6350:6350'
            - '6355:6355'
            - '6356:6356'
            - '6360:6360'
            - '6365:6365'
            - '6366:6366'
            - '6370:6370'
            - '6375:6375'
            - '6376:6376'
            - '6380:6380'
            - '6385:6385'
            - '6386:6386'
            - '6390:6390'
            - '6395:6395'
            - '6396:6396'
            - '6400:6400'
            - '6405:6405'
            - '6406:6406'
            - '6410:6410'
            - '6415:6415'
            - '6416:6416'
            - '6420:6420'
            - '6425:6425'
            - '6426:6426'
            - '6430:6430'
            - '6435:6435'
            - '6436:6436'
            - '6440:6440'
            - '6445:6445'
            - '6446:6446'
            - '6450:6450'
            - '6455:6455'
            - '6456:6456'
            - '6460:6460'
            - '6465:6465'
            - '6466:6466'
            - '6470:6470'
            - '6475:6475'
            - '6476:6476'
            - '6480:6480'
            - '6485:6485'
            - '6486:6486'
            - '6490:6490'
            - '6495:6495'
            - '6496:6496'
            - '6500:6500'
            - '6505:6505'
            - '6506:6506'
            - '6510:6510'
            - '6515:6515'
            - '6516:6516'
            - '6520:6520'
            - '6525:6525'
            - '6526:6526'
            - '6530:6530'
            - '6535:6535'
            - '6536:6536'
            - '6540:6540'
            - '6545:6545'
            - '6546:6546'
            - '6550:6550'
            - '6555:6555'
            - '6556:6556'
            - '6560:6560'
            - '6565:6565'
            - '6566:6566'
            - '6570:6570'
            - '6575:6575'
            - '6576:6576'
            - '6580:6580'
            - '6585:6585'
            - '6586:6586'
            - '6590:6590'
            - '6595:6595'
            - '6596:6596'
            - '6600:6600'
            - '6605:6605'
            - '6606:6606'
            - '6610:6610'
            - '6615:6615'
            - '6616:6616'
            - '6620:6620'
            - '6625:6625'
            - '6626:6626'
            - '6630:6630'
            - '6635:6635'
            - '6636:6636'
            - '6640:6640'
            - '6645:6645'
            - '6646:6646'
            - '6650:6650'
            - '6655:6655'
            - '6656:6656'
            - '6660:6660'
            - '6665:6665'
            - '6666:6666'
            - '6670:6670'
            - '6675:6675'
            - '6676:6676'
            - '6680:6680'
            - '6685:6685'
            - '6686:6686'
            - '6690:6690'
            - '6695:6695'
            - '6696:6696'
            - '6700:6700'
            - '6705:6705'
            - '6706:6706'
            - '6710:6710'
            - '6715:6715'
            - '6716:6716'
            - '6720:6720'
            - '6725:6725'
            - '6726:6726'
            - '6730:6730'
            - '6735:6735'
            - '6736:6736'
            - '6740:6740'
            - '6745:6745'
            - '6746:6746'
            - '6750:6750'
            - '6755:6755'
            - '6756:6756'
            - '6760:6760'
            - '6765:6765'
            - '6766:6766'
            - '6770:6770'
            - '6775:6775'
            - '6776:6776'
            - '6780:6780'
            - '6785:6785'
            - '6786:6786'
            - '6790:6790'
            - '6795:6795'
            - '6796:6796'
            - '6800:6800'
            - '6805:6805'
            - '6806:6806'
            - '6810:6810'
            - '6815:6815'
            - '6816:6816'
            - '6820:6820'
            - '6825:6825'
            - '6826:6826'
            - '6830:6830'
            - '6835:6835'
            - '6836:6836'
            - '6840:6840'
            - '6845:6845'
            - '6846:6846'
            - '6850:6850'
            - '6855:6855'
            - '6856:6856'
            - '6860:6860'
            - '6865:6865'
            - '6866:6866'
            - '6870:6870'
            - '6875:6875'
            - '6876:6876'
            - '6880:6880'
            - '6885:6885'
            - '6886:6886'
            - '6890:6890'
            - '6895:6895'
            - '6896:6896'
            - '6900:6900'
            - '6905:6905'
            - '6906:6906'
            - '6910:6910'
            - '6915:6915'
            - '6916:6916'
            - '6920:6920'
            - '6925:6925'
            - '6926:6926'
            - '6930:6930'
            - '6935:6935'
            - '6936:6936'
            - '6940:6940'
            - '6945:6945'
            - '6946:6946'
            - '6950:6950'
            - '6955:6955'
            - '6956:6956'
            - '6960:6960'
            - '6965:6965'
            - '6966:6966'
            - '6970:6970'
            - '6975:6975'
            - '6976:6976'
            - '6980:6980'
            - '6985:6985'
            - '6986:6986'
            - '6990:6990'
            - '6995:6995'
            - '6996:6996'
        volumes:
            - 'station_data:/var/azuracast/stations'
            - 'shoutcast2_install:/var/azuracast/servers/shoutcast2'
            - 'letsencrypt:/etc/nginx/certs'
            - 'tmp_data:/var/azuracast/www_tmp'
        networks:
            - frontend
            - backend
        init: true
        restart: unless-stopped
        ulimits:
            nofile:
                soft: 65536
                hard: 65536
        logging:
            options:
                max-size: 1m
                max-file: '5'
networks:
    frontend:
        driver: bridge
    backend:
        driver: bridge
volumes:
    db_data: {  }
    letsencrypt: {  }
    letsencrypt_acme: {  }
    shoutcast2_install: {  }
    geolite_install: {  }
    sftpgo_data: {  }
    station_data: {  }
    www_vendor: {  }
    www_uploads: {  }
    tmp_data: {  }
    redis_data: {  }
    backups: {  }
